<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Consultazione Orari Pullman Castellammare di Stabia - Lettere">
    <meta name="keywords" content="orari pullman, Castellammare, Lettere, trasporti pubblici">
    <meta name="author" content="Noyla">
    <title>StabiaBUS</title>

    <meta name="theme-color" content="#1a237e">
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=swap_horiz" />

    <link rel="icon" sizes="500x500" href="StabiaBUS BGRM.png">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-content">
                <div class="header-top">
                    <div>
                        <h1 class="app-title">üöå StabiaBUS</h1>
                        <p class="app-subtitle" id="current-datetime">Caricamento...</p>
                    </div>
                    <button id="theme-toggle" class="theme-toggle" aria-label="Cambia tema">
                        <span class="theme-icon sun">‚òÄÔ∏è</span>
                        <span class="theme-icon moon">üåô</span>
                    </button>
                </div>

                <nav class="nav-tabs">
                    <button class="nav-tab active" data-tab="chatbot">‚è±Ô∏è Orari</button>
                    <button class="nav-tab" data-tab="settings">‚öôÔ∏è Impostazioni</button>
                </nav>
            </div>
        </header>

        <main class="main-content">
            <div id="chatbot-tab" class="tab-content active">
                <div class="search-container">
                    <div class="search-header">
                        <h2>Ricerca Orari Pullman</h2>
                        <p>Utilizza i filtri per trovare le corse disponibili</p>
                    </div>

                    <div id="alerts-container-search"></div>

                    <form id="search-form" class="search-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="partenza-select" class="form-label">
                                    <span class="label-icon">üìç</span>
                                    Partenza
                                </label>
                                <select id="partenza-select" class="form-select">
                                    <option value="">-- Seleziona Fermata --</option>
                                </select>
                                <small class="form-hint">Seleziona fermata di partenza</small>
                            </div>

                            <!-- Swap Button -->
                            <div class="swap-button-container">
                                <button type="button" id="swap-stops-btn" class="swap-stops-button"
                                    title="Inverti partenza e destinazione">
                                    <span class="material-symbols-outlined">swap_horiz</span>
                                </button>
                            </div>

                            <div class="form-group">
                                <label for="destinazione-select" class="form-label">
                                    <span class="label-icon">üéØ</span>
                                    Destinazione
                                </label>
                                <select id="destinazione-select" class="form-select">
                                    <option value="">-- Tutte le destinazioni --</option>
                                </select>
                                <small class="form-hint">Seleziona fermata di arrivo o linea</small>
                            </div>
                        </div>

                        <!-- Line Selection (Visible by default) -->
                        <div id="line-selection-container" class="form-group fade-in">
                            <label class="form-label">
                                <span class="label-icon">üöå</span>
                                Seleziona Linea / Direzione
                            </label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="fallback-direction" value="andata" checked>
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Verso Castellammare</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="fallback-direction" value="ritorno">
                                    <span class="radio-custom"></span>
                                    <span class="radio-label">Verso Lettere</span>
                                </label>
                            </div>
                            <small class="form-hint">Poich√© non hai scelto una destinazione, seleziona la direzione per
                                vedere tutte le fermate successive.</small>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">‚è∞</span>
                                Fascia Oraria
                            </label>
                            <div class="time-range">
                                <div class="time-input-group">
                                    <label for="ora-inizio">Da</label>
                                    <input type="time" id="ora-inizio" class="form-time">
                                </div>
                                <span class="time-separator">‚Üí</span>
                                <div class="time-input-group">
                                    <label for="ora-fine">A</label>
                                    <input type="time" id="ora-fine" class="form-time">
                                </div>
                            </div>
                            <small class="form-hint">Opzionale - lascia vuoto per vedere tutti gli orari</small>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">üìÖ</span>
                                Tipo Giorno (seleziona uno o pi√π)
                            </label>
                            <div class="checkbox-group">
                                <label class="radio-option">
                                    <input type="checkbox" name="dayType" value="feriale" checked>
                                    <span class="radio-label">Feriale (Lun-Sab)</span>
                                </label>
                                <label class="radio-option">
                                    <input type="checkbox" name="dayType" value="festivo">
                                    <span class="radio-label">Festivo (Domenica e Festivi)</span>
                                </label>
                                <label class="radio-option">
                                    <input type="checkbox" name="dayType" value="sabato">
                                    <span class="radio-label">Sabato</span>
                                </label>
                                <label class="radio-option">
                                    <input type="checkbox" name="dayType" value="scolastico">
                                    <span class="radio-label">Scolastico</span>
                                </label>
                            </div>
                            <small class="form-hint">Seleziona una o pi√π opzioni per filtrare le corse</small>
                        </div>

                        <button type="submit" class="search-button">
                            <span class="button-icon">üîç</span>
                            Cerca Orari
                        </button>
                    </form>

                    <div id="results-container" class="results-section">
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="tab-content">
                <div class="settings-container">
                    <div class="settings-header">
                        <h2>‚öôÔ∏è Impostazioni</h2>
                        <p>Personalizza le tue fermate preferite per una ricerca pi√π veloce</p>
                    </div>

                    <div id="settings-alerts"></div>

                    <!-- Fermate Personalizzate -->
                    <div class="settings-section">
                        <h3>üè† Fermate Personalizzate</h3>
                        <p class="section-description">Imposta le tue fermate pi√π utilizzate. Appariranno per prime nei
                            menu di ricerca.</p>

                        <div class="custom-stops-grid">
                            <div class="custom-stop-card">
                                <div class="card-icon">üè†</div>
                                <label for="home-stop">Casa</label>
                                <select id="home-stop" class="form-select">
                                    <option value="">-- Non impostata --</option>
                                </select>
                            </div>

                            <div class="custom-stop-card">
                                <div class="card-icon">üíº</div>
                                <label for="work-stop">Lavoro</label>
                                <select id="work-stop" class="form-select">
                                    <option value="">-- Non impostata --</option>
                                </select>
                            </div>

                            <div class="custom-stop-card">
                                <div class="card-icon">üéì</div>
                                <label for="school-stop">Scuola</label>
                                <select id="school-stop" class="form-select">
                                    <option value="">-- Non impostata --</option>
                                </select>
                            </div>
                        </div>

                        <button id="save-custom-stops" class="settings-button primary">üíæ Salva Fermate
                            Personalizzate</button>
                    </div>

                    <!-- Fermate Preferite -->
                    <div class="settings-section">
                        <h3>‚≠ê Fermate Preferite</h3>
                        <p class="section-description">Aggiungi le fermate che usi pi√π spesso per accedervi rapidamente
                        </p>

                        <div class="add-favorite">
                            <select id="add-favorite-select" class="form-select">
                                <option value="">-- Seleziona una fermata --</option>
                            </select>
                            <button id="add-favorite-btn" class="settings-button">‚ûï Aggiungi</button>
                        </div>

                        <div id="favorites-list" class="favorites-list">
                            <p class="empty-state">Nessuna fermata preferita. Aggiungine una sopra!</p>
                        </div>
                    </div>

                    <!-- Reset -->
                    <div class="settings-section">
                        <h3>üîÑ Reset Impostazioni</h3>
                        <p class="section-description">Ripristina tutte le impostazioni ai valori predefiniti</p>
                        <button id="reset-settings" class="settings-button danger">üóëÔ∏è Ripristina Tutto</button>
                    </div>
                </div>
            </div>
        </main>

        <script>
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    // Registra il Service Worker nella root per coprire l'intera applicazione
                    navigator.serviceWorker.register('./service-worker.js')
                        .then(reg => console.log('Service Worker registrato con successo. Scope:', reg.scope))
                        .catch(err => console.error('Registrazione Service Worker fallita:', err));
                });
            }
        </script>

        <script src="schedules-data.js"></script>
        <script src="app.js"></script>
        <script src="chatbot.js"></script>
        <script src="settings.js"></script>
</body>

</html>
